import pandas as pd
import os, sys
import copy
import time
import gc
from easynmt import EasyNMT
import nltk
from torch.cuda import OutOfMemoryError
import torch
from copy import deepcopy


## Translate multilingual ASAP data (to compare against their DeepL translation)

nltk.download('punkt')

data_path = '/data/ASAP_crosslingual/split'
languages = ['de', 'en', 'es', 'fr', 'zh']
language_codes = {'de': 'de', 'es': 'es', 'fr': 'fr', 'ar': 'ar', 'da': 'da', 'en': 'en', 'he': 'he', 'it': 'it', 'ka': 'ka', 'nb': 'no', 'pt': 'pt', 'sl': 'sl', 'sv': 'sv', 'zh': 'zh'}

num_folds = 7

translation_model_name = 'm2m_100_1.2B'
translation_model = EasyNMT(translation_model_name, max_loaded_models=1)

for prompt in ['1','2','10']:
# for prompt in os.listdir(data_path):

    print(prompt)

    for language in languages:

        for fold in range(1, num_folds + 1):

            df = pd.read_csv(os.path.join(data_path, prompt, language, 'fold_' + str(fold) + '.csv'))

            other_languages = deepcopy(languages)
            other_languages.remove(language)

            for other_language in other_languages:

                target_file = os.path.join(data_path, prompt, language, 'fold_' + str(fold) + '_translated_' + other_language + '_' + translation_model_name + '.csv')

                if not os.path.exists(target_file):

                    print('Translating', prompt, language, other_language, fold)

                    df_copy = copy.deepcopy(df)
                    df_copy['text'] = df_copy['text'].apply(str)

                    # df_test_copy['Value'] = translation_model.translate(df_test_copy['Value'], source_lang=language_codes[language], target_lang=language_codes[other_language])
                    # df_copy['text'] = [translation_model.translate(sentence, source_lang=language_codes[language], target_lang=language_codes[other_language]) for sentence in list(df_copy['text'])]

                    ### to debug
                    translated_texts = []
                    original_texts = list(df_copy['text'])

                    for text in original_texts:

                        print(len(text), text)

                        if other_language=='de' and text == 'Lluvia ácidanLa lluvia ácida es una forma de contaminación ácida, que hace referencia a la caída (deposición) de ácidos presentes en la atmósfera a través de la lluvia, niebla y nieve (también conocida como deposición húmeda).nLos principales precursores de los ácidos, son los óxidos de azufre (SOx) y los óxidos de nitrógeno (NOx), que son emitidos por las termoeléctricas, los motores de combustión interna de coches y aviones y algunas otras industrias, como producto de la combustión de combustibles que contienen pequeños porcentajes de azufre (S) y nitrógeno (N), como el carbón, gas natural, gas oil, petróleo, etc.nLos ácidos, principalmente ácido sulfúrico y ácido nítrico, se disuelven en las gotas de agua que forman las nubes y en las propias gotas de agua de lluvia, depositándose en el suelo. Ambos ácidos se originan en la atmósfera al reaccionar el trióxido de azufre (SO3) y el dióxido de nitrógeno (NO2) con agua, oxígeno y otras sustancias químicas presentes. En presencia de luz solar aumenta la velocidad de la mayoría de estas reacciones.nExiste también otra forma de contaminación ácida conocida como deposición seca, y hace referencia a gases y partículas ácidos que son arrastrados por el viento, chocando contra edificios, coches, casas y árboles. Otra vía de arrastre son las lluvias fuertes. En este caso las sustancias ácidas se incorporan a la lluvia ácida, lo que contribuye a aumentar su acidez.nAproximadamente la mitad de las sustancias ácidas en la atmósfera caen al suelo por procesos de deposición seca.n¿Cómo se mide la lluvia ácida?nLa lluvia ácida se mide según la escala de "pH", potencial hidrógeno. Cuanto más bajo sea el pH de una sustancia, es más ácida.nEl agua pura tiene un pH de 7.0 y normalmente la lluvia tiene un pH entre 5 y 6, es decir, es ligeramente ácida, por llevar ácido carbónico que se forma cuando el dióxido de carbono del aire se disuelve en el agua que cae. En cambio, en zonas con la atmósfera contaminada por estas sustancias acidificantes, la lluvia tiene valores de pH de hasta 4 ó 3 y, en algunas zonas en que la niebla es ácida, el pH puede llegar a ser de 2 ó 3, es decir similar al del zumo del limón o al del vinagre.n¿Cuáles son los efectos de la lluvia ácida?nLos efectos ocasionados por el agua ácida dependerán de diversos factores, como el grado de acidez del agua, la composición química del suelo y su capacidad de "amortiguación" (buffering), así como de las características de los organismos vivos afectados.nLa deposición ácida contribuye a la reducción del pH en ecosistemas terrestres y acuáticos y permite la movilización de metales tóxicos, especialmente del aluminio. Esto ocasiona una variedad de efectos, como son daños a bosques y suelos, peces y otros seres vivos, materiales de construcción y a la salud humana. Asimismo, la lluvia ácida actúa reduciendo la visibilidad.nEn los bosques, la lluvia ácida produce daños al descomponer los nutrientes del suelo, dificultando el crecimiento natural de los árboles. El daño se puede extender a los pastos de las praderas, perjudicando al ganado, y a los lagos, pudiendo ocasionar la muerte de gran cantidad de peces.nLos efectos de la lluvia ácida en el suelo pueden verse incrementados en bosques de zonas de alta montaña, donde la niebla contribuye a aportar cantidades importantes de los contaminantes ácidos.nLa lluvia ácida contribuye a la degradación de los materiales de construcción y artísticos (mal de piedra) y la corrosión metálica. Los monumentos y edificios son sensibles a la acción de la lluvia ácida. Muchas ruinas han desaparecido o están por de hacerlo, a causa de este factor.nEl daño que produce a las personas es principalmente indirecto, mediante el consumo de peces y agua potable contaminados por la lluvia ácida.n¿Cómo se puede reducir la lluvia ácida?nPara reducir la lluvia ácida es necesario disminuir la emisión de los compuestos químicos que dan origen a los ácidos, es decir, de los precursores de los ácidos, los cuales son principalmente el bióxido de azufre (SO2) y los óxidos de nitrógeno (monóxido de nitrógeno, NO, y bióxido de nitrógeno, NO2).nEn la actualidad se puede disminuir la formación de SO2 eliminando el azufre de los combustibles fósiles o atrapando los SOx antes que se emitan a la atmósfera, mediante reacciones químicas que los transforman en especies químicas menos reactivas. La utilización de convertidores catalíticos disminuye la formación de NO y NO2, puesto que reducen dichos óxidos a N2 y O2.':
                            
                            translated_texts.append('Saurer RegenSaurer Regen ist eine Form der sauren Verschmutzung, die sich auf den Niederschlag (Ablagerung) von Säuren in der Atmosphäre durch Regen, Nebel und Schnee (auch als nasse Ablagerung bezeichnet) bezieht. Die wichtigsten Vorläufersubstanzen von Säuren sind Schwefeloxide (SOx) und Stickoxide (NOx), die von Kraftwerken, Verbrennungsmotoren von Autos und Flugzeugen und einigen anderen Industriezweigen als Produkt der Verbrennung von Brennstoffen mit geringen Anteilen an Schwefel (S) und Stickstoff (N), wie Kohle, Erdgas, Gasöl, Erdöl usw., ausgestoßen werden. nSäuren, vor allem Schwefel- und Salpetersäure, lösen sich in den Wassertröpfchen, die Wolken bilden, und in den Regentropfen selbst und lagern sich auf dem Boden ab. Beide Säuren entstehen in der Atmosphäre, wenn Schwefeltrioxid (SO3) und Stickstoffdioxid (NO2) mit Wasser, Sauerstoff und anderen vorhandenen Chemikalien reagieren. In Gegenwart von Sonnenlicht erhöht sich die Geschwindigkeit der meisten dieser Reaktionen.n Es gibt noch eine andere Form der sauren Verschmutzung, die als trockene Ablagerung bekannt ist und sich auf saure Gase und Partikel bezieht, die vom Wind getragen werden und auf Gebäude, Autos, Häuser und Bäume treffen. Ein weiterer Weg der Abschwemmung sind starke Regenfälle. In diesem Fall werden saure Stoffe in den sauren Regen eingebaut, was zu einer Erhöhung seines Säuregehalts beiträgt.nUngefähr die Hälfte der sauren Stoffe in der Atmosphäre fällt durch trockene Ablagerung auf den Boden.nWie wird saurer Regen gemessen?nSaurer Regen wird anhand der "pH"-Skala, dem Wasserstoffpotenzial, gemessen. Je niedriger der pH-Wert einer Substanz ist, desto saurer ist sie.nReines Wasser hat einen pH-Wert von 7,0, und Regen hat normalerweise einen pH-Wert zwischen 5 und 6, d. h. er ist leicht sauer und enthält Kohlensäure, die sich bildet, wenn sich Kohlendioxid aus der Luft im fallenden Wasser löst. In Gebieten, in denen die Atmosphäre durch diese säurebildenden Stoffe verunreinigt ist, hat der Regen dagegen pH-Werte von bis zu 4 oder 3, und in einigen Gebieten, in denen der Nebel sauer ist, kann der pH-Wert sogar 2 oder 3 betragen, ähnlich wie bei Zitronensaft oder Essig.n Welche Auswirkungen hat saurer Regen? nDie Auswirkungen von saurem Wasser hängen von mehreren Faktoren ab, wie dem Säuregrad des Wassers, der chemischen Zusammensetzung des Bodens und seiner Pufferkapazität sowie den Eigenschaften der betroffenen Lebewesen.nDie saure Ablagerung trägt zur Senkung des pH-Werts in terrestrischen und aquatischen Ökosystemen bei und ermöglicht die Mobilisierung giftiger Metalle, insbesondere von Aluminium. Dies hat eine Vielzahl von Auswirkungen, darunter Schäden an Wäldern und Böden, Fischen und anderen Lebewesen, Baumaterialien und der menschlichen Gesundheit. Saurer Regen beeinträchtigt auch die Sichtbarkeit.n In Wäldern verursacht saurer Regen Schäden, indem er Bodennährstoffe zersetzt und das natürliche Wachstum von Bäumen behindert. Die Schäden können sich auch auf Weiden ausdehnen und das Vieh schädigen sowie auf Seen, in denen möglicherweise eine große Anzahl von Fischen getötet wird.n Die Auswirkungen des sauren Regens auf den Boden können in Wäldern in Hochgebirgsregionen verstärkt werden, wo der Nebel erhebliche Mengen an sauren Schadstoffen einbringt.n Saurer Regen trägt zur Zersetzung von Bau- und Kunstmaterialien (z. B. schlechter Stein) und zur Metallkorrosion bei. Denkmäler und Gebäude reagieren empfindlich auf die Wirkung des sauren Regens. Viele Ruinen sind aufgrund dieses Faktors verschwunden oder stehen kurz davor.nDie Menschen werden hauptsächlich indirekt geschädigt, durch den Verzehr von Fisch und Trinkwasser, das durch sauren Regen verunreinigt ist.nWie kann saurer Regen reduziert werden? nUm den sauren Regen zu reduzieren, muss die Emission der chemischen Verbindungen, die zu Säuren führen, d. h. der Säurevorläufer, reduziert werden. Dabei handelt es sich hauptsächlich um Schwefeldioxid (SO2) und Stickoxide (Stickstoffmonoxid, NO, und Stickstoffdioxid, NO2). Heutzutage kann die SO2-Bildung durch die Entfernung von Schwefel aus fossilen Brennstoffen oder durch das Abfangen von SOx vor seiner Emission in die Atmosphäre durch chemische Reaktionen, die es in weniger reaktive chemische Spezies umwandeln, reduziert werden. Der Einsatz von Katalysatoren verringert die Bildung von NO und NO2, indem diese Oxide zu N2 und O2 reduziert werden.')
                            print('APPENDED DEEPL')

                        elif other_language=='en' and text == 'Lluvia ácidanLa lluvia ácida es una forma de contaminación ácida, que hace referencia a la caída (deposición) de ácidos presentes en la atmósfera a través de la lluvia, niebla y nieve (también conocida como deposición húmeda).nLos principales precursores de los ácidos, son los óxidos de azufre (SOx) y los óxidos de nitrógeno (NOx), que son emitidos por las termoeléctricas, los motores de combustión interna de coches y aviones y algunas otras industrias, como producto de la combustión de combustibles que contienen pequeños porcentajes de azufre (S) y nitrógeno (N), como el carbón, gas natural, gas oil, petróleo, etc.nLos ácidos, principalmente ácido sulfúrico y ácido nítrico, se disuelven en las gotas de agua que forman las nubes y en las propias gotas de agua de lluvia, depositándose en el suelo. Ambos ácidos se originan en la atmósfera al reaccionar el trióxido de azufre (SO3) y el dióxido de nitrógeno (NO2) con agua, oxígeno y otras sustancias químicas presentes. En presencia de luz solar aumenta la velocidad de la mayoría de estas reacciones.nExiste también otra forma de contaminación ácida conocida como deposición seca, y hace referencia a gases y partículas ácidos que son arrastrados por el viento, chocando contra edificios, coches, casas y árboles. Otra vía de arrastre son las lluvias fuertes. En este caso las sustancias ácidas se incorporan a la lluvia ácida, lo que contribuye a aumentar su acidez.nAproximadamente la mitad de las sustancias ácidas en la atmósfera caen al suelo por procesos de deposición seca.n¿Cómo se mide la lluvia ácida?nLa lluvia ácida se mide según la escala de "pH", potencial hidrógeno. Cuanto más bajo sea el pH de una sustancia, es más ácida.nEl agua pura tiene un pH de 7.0 y normalmente la lluvia tiene un pH entre 5 y 6, es decir, es ligeramente ácida, por llevar ácido carbónico que se forma cuando el dióxido de carbono del aire se disuelve en el agua que cae. En cambio, en zonas con la atmósfera contaminada por estas sustancias acidificantes, la lluvia tiene valores de pH de hasta 4 ó 3 y, en algunas zonas en que la niebla es ácida, el pH puede llegar a ser de 2 ó 3, es decir similar al del zumo del limón o al del vinagre.n¿Cuáles son los efectos de la lluvia ácida?nLos efectos ocasionados por el agua ácida dependerán de diversos factores, como el grado de acidez del agua, la composición química del suelo y su capacidad de "amortiguación" (buffering), así como de las características de los organismos vivos afectados.nLa deposición ácida contribuye a la reducción del pH en ecosistemas terrestres y acuáticos y permite la movilización de metales tóxicos, especialmente del aluminio. Esto ocasiona una variedad de efectos, como son daños a bosques y suelos, peces y otros seres vivos, materiales de construcción y a la salud humana. Asimismo, la lluvia ácida actúa reduciendo la visibilidad.nEn los bosques, la lluvia ácida produce daños al descomponer los nutrientes del suelo, dificultando el crecimiento natural de los árboles. El daño se puede extender a los pastos de las praderas, perjudicando al ganado, y a los lagos, pudiendo ocasionar la muerte de gran cantidad de peces.nLos efectos de la lluvia ácida en el suelo pueden verse incrementados en bosques de zonas de alta montaña, donde la niebla contribuye a aportar cantidades importantes de los contaminantes ácidos.nLa lluvia ácida contribuye a la degradación de los materiales de construcción y artísticos (mal de piedra) y la corrosión metálica. Los monumentos y edificios son sensibles a la acción de la lluvia ácida. Muchas ruinas han desaparecido o están por de hacerlo, a causa de este factor.nEl daño que produce a las personas es principalmente indirecto, mediante el consumo de peces y agua potable contaminados por la lluvia ácida.n¿Cómo se puede reducir la lluvia ácida?nPara reducir la lluvia ácida es necesario disminuir la emisión de los compuestos químicos que dan origen a los ácidos, es decir, de los precursores de los ácidos, los cuales son principalmente el bióxido de azufre (SO2) y los óxidos de nitrógeno (monóxido de nitrógeno, NO, y bióxido de nitrógeno, NO2).nEn la actualidad se puede disminuir la formación de SO2 eliminando el azufre de los combustibles fósiles o atrapando los SOx antes que se emitan a la atmósfera, mediante reacciones químicas que los transforman en especies químicas menos reactivas. La utilización de convertidores catalíticos disminuye la formación de NO y NO2, puesto que reducen dichos óxidos a N2 y O2.':
                            
                            translated_texts.append('Acid rainAcid rain is a form of acid pollution, which refers to the fall (deposition) of acids present in the atmosphere through rain, fog and snow (also known as wet deposition). nThe main precursors of acids are sulfur oxides (SOx) and nitrogen oxides (NOx), which are emitted by thermoelectric power plants, internal combustion engines of cars and airplanes, and some other industries, as a product of the combustion of fuels containing small percentages of sulfur (S) and nitrogen (N), such as coal, natural gas, gas oil, petroleum, etc. nAcids, mainly sulfuric acid and nitric acid, dissolve in the water droplets that form clouds and in the raindrops themselves, and are deposited on the ground. Both acids originate in the atmosphere when sulfur trioxide (SO3) and nitrogen dioxide (NO2) react with water, oxygen and other chemicals present. In the presence of sunlight, the rate of most of these reactions increases.nThere is also another form of acid pollution known as dry deposition, which refers to acidic gases and particles that are carried by the wind, hitting buildings, cars, houses and trees. Another way of entrainment is heavy rainfall. In this case acidic substances are incorporated into acid rain, which contributes to its acidity.nApproximately half of the acidic substances in the atmosphere fall to the ground through dry deposition processes.nHow is acid rain measured?nAcid rain is measured on the "pH" scale, hydrogen potential. The lower the pH of a substance, the more acidic it is.nPure water has a pH of 7.0 and rain normally has a pH between 5 and 6, i.e., it is slightly acidic, carrying carbonic acid that forms when carbon dioxide from the air dissolves in the falling water. On the other hand, in areas where the atmosphere is polluted by these acidifying substances, the rain has pH values of up to 4 or 3 and, in some areas where the fog is acidic, the pH can reach 2 or 3, i.e. similar to that of lemon juice or vinegar.nWhat are the effects of acid rain? nThe effects caused by acidic water will depend on several factors, such as the degree of acidity of the water, the chemical composition of the soil and its buffering capacity, as well as the characteristics of the living organisms affected.nAcid deposition contributes to the lowering of pH in terrestrial and aquatic ecosystems and allows the mobilization of toxic metals, especially aluminum. This causes a variety of effects, such as damage to forests and soils, fish and other living things, building materials and human health. Acid rain also acts to reduce visibility.n In forests, acid rain causes damage by decomposing soil nutrients, hindering the natural growth of trees. The damage can extend to prairie grasses, harming livestock, and to lakes, potentially killing large numbers of fish.n The effects of acid rain on soil can be magnified in high mountain forests, where fog contributes significant amounts of acid pollutants.n Acid rain contributes to the degradation of building and art materials (stone disease) and metal corrosion. Monuments and buildings are sensitive to the action of acid rain. Many ruins have disappeared or are about to disappear because of this factor.nHarm to people is mainly indirect, through the consumption of fish and drinking water contaminated by acid rain.nHow can acid rain be reduced? nTo reduce acid rain, it is necessary to reduce the emission of the chemical compounds that give rise to acids, i.e., acid precursors, which are mainly sulfur dioxide (SO2) and nitrogen oxides (nitrogen monoxide, NO, and nitrogen dioxide, NO2). Today, SO2 formation can be reduced by removing sulfur from fossil fuels or by trapping SOx before it is emitted into the atmosphere, through chemical reactions that transform it into less reactive chemical species. The use of catalytic converters reduces the formation of NO and NO2 by reducing these oxides to N2 and O2.')
                            print('APPENDED DEEPL')

                        elif other_language=='fr' and text == 'Lluvia ácidanLa lluvia ácida es una forma de contaminación ácida, que hace referencia a la caída (deposición) de ácidos presentes en la atmósfera a través de la lluvia, niebla y nieve (también conocida como deposición húmeda).nLos principales precursores de los ácidos, son los óxidos de azufre (SOx) y los óxidos de nitrógeno (NOx), que son emitidos por las termoeléctricas, los motores de combustión interna de coches y aviones y algunas otras industrias, como producto de la combustión de combustibles que contienen pequeños porcentajes de azufre (S) y nitrógeno (N), como el carbón, gas natural, gas oil, petróleo, etc.nLos ácidos, principalmente ácido sulfúrico y ácido nítrico, se disuelven en las gotas de agua que forman las nubes y en las propias gotas de agua de lluvia, depositándose en el suelo. Ambos ácidos se originan en la atmósfera al reaccionar el trióxido de azufre (SO3) y el dióxido de nitrógeno (NO2) con agua, oxígeno y otras sustancias químicas presentes. En presencia de luz solar aumenta la velocidad de la mayoría de estas reacciones.nExiste también otra forma de contaminación ácida conocida como deposición seca, y hace referencia a gases y partículas ácidos que son arrastrados por el viento, chocando contra edificios, coches, casas y árboles. Otra vía de arrastre son las lluvias fuertes. En este caso las sustancias ácidas se incorporan a la lluvia ácida, lo que contribuye a aumentar su acidez.nAproximadamente la mitad de las sustancias ácidas en la atmósfera caen al suelo por procesos de deposición seca.n¿Cómo se mide la lluvia ácida?nLa lluvia ácida se mide según la escala de "pH", potencial hidrógeno. Cuanto más bajo sea el pH de una sustancia, es más ácida.nEl agua pura tiene un pH de 7.0 y normalmente la lluvia tiene un pH entre 5 y 6, es decir, es ligeramente ácida, por llevar ácido carbónico que se forma cuando el dióxido de carbono del aire se disuelve en el agua que cae. En cambio, en zonas con la atmósfera contaminada por estas sustancias acidificantes, la lluvia tiene valores de pH de hasta 4 ó 3 y, en algunas zonas en que la niebla es ácida, el pH puede llegar a ser de 2 ó 3, es decir similar al del zumo del limón o al del vinagre.n¿Cuáles son los efectos de la lluvia ácida?nLos efectos ocasionados por el agua ácida dependerán de diversos factores, como el grado de acidez del agua, la composición química del suelo y su capacidad de "amortiguación" (buffering), así como de las características de los organismos vivos afectados.nLa deposición ácida contribuye a la reducción del pH en ecosistemas terrestres y acuáticos y permite la movilización de metales tóxicos, especialmente del aluminio. Esto ocasiona una variedad de efectos, como son daños a bosques y suelos, peces y otros seres vivos, materiales de construcción y a la salud humana. Asimismo, la lluvia ácida actúa reduciendo la visibilidad.nEn los bosques, la lluvia ácida produce daños al descomponer los nutrientes del suelo, dificultando el crecimiento natural de los árboles. El daño se puede extender a los pastos de las praderas, perjudicando al ganado, y a los lagos, pudiendo ocasionar la muerte de gran cantidad de peces.nLos efectos de la lluvia ácida en el suelo pueden verse incrementados en bosques de zonas de alta montaña, donde la niebla contribuye a aportar cantidades importantes de los contaminantes ácidos.nLa lluvia ácida contribuye a la degradación de los materiales de construcción y artísticos (mal de piedra) y la corrosión metálica. Los monumentos y edificios son sensibles a la acción de la lluvia ácida. Muchas ruinas han desaparecido o están por de hacerlo, a causa de este factor.nEl daño que produce a las personas es principalmente indirecto, mediante el consumo de peces y agua potable contaminados por la lluvia ácida.n¿Cómo se puede reducir la lluvia ácida?nPara reducir la lluvia ácida es necesario disminuir la emisión de los compuestos químicos que dan origen a los ácidos, es decir, de los precursores de los ácidos, los cuales son principalmente el bióxido de azufre (SO2) y los óxidos de nitrógeno (monóxido de nitrógeno, NO, y bióxido de nitrógeno, NO2).nEn la actualidad se puede disminuir la formación de SO2 eliminando el azufre de los combustibles fósiles o atrapando los SOx antes que se emitan a la atmósfera, mediante reacciones químicas que los transforman en especies químicas menos reactivas. La utilización de convertidores catalíticos disminuye la formación de NO y NO2, puesto que reducen dichos óxidos a N2 y O2.':
                            
                            translated_texts.append("Pluies acidesLes pluies acides sont une forme de pollution acide qui désigne les retombées (dépôts) d'acides présents dans l'atmosphère par le biais de la pluie, du brouillard et de la neige (également connus sous le nom de dépôts humides). Les principaux précurseurs des acides sont les oxydes de soufre (SOx) et les oxydes d'azote (NOx), qui sont émis par les centrales électriques, les moteurs à combustion interne des voitures et des avions et certaines autres industries, en tant que produit de la combustion de combustibles contenant de faibles pourcentages de soufre (S) et d'azote (N), tels que le charbon, le gaz naturel, le gasoil, le pétrole, etc. nLes acides, principalement l'acide sulfurique et l'acide nitrique, se dissolvent dans les gouttelettes d'eau qui forment les nuages et dans les gouttes de pluie elles-mêmes, se déposant sur le sol. Ces deux acides proviennent de l'atmosphère lorsque le trioxyde de soufre (SO3) et le dioxyde d'azote (NO2) réagissent avec l'eau, l'oxygène et d'autres substances chimiques présentes. En présence de lumière solaire, le taux de la plupart de ces réactions augmente.n Il existe également une autre forme de pollution acide connue sous le nom de dépôt sec, qui se réfère aux gaz et particules acides transportés par le vent, frappant les bâtiments, les voitures, les maisons et les arbres. Les fortes précipitations constituent une autre voie de lessivage. Dans ce cas, les substances acides sont incorporées dans les pluies acides, ce qui contribue à augmenter leur acidité.nEnviron la moitié des substances acides présentes dans l'atmosphère tombent au sol par le biais des processus de dépôt sec.nComment mesure-t-on les pluies acides?nLes pluies acides sont mesurées selon l'échelle du 'pH', le potentiel d'hydrogène. Plus le pH d'une substance est faible, plus elle est acide.nL'eau pure a un pH de 7,0 et la pluie a normalement un pH compris entre 5 et 6, c'est-à-dire qu'elle est légèrement acide et contient de l'acide carbonique qui se forme lorsque le dioxyde de carbone de l'air se dissout dans l'eau qui tombe. En revanche, dans les régions où l'atmosphère est polluée par ces substances acidifiantes, le pH de la pluie peut atteindre 4 ou 3, et dans certaines régions où le brouillard est acide, le pH peut atteindre 2 ou 3, comme celui du jus de citron ou du vinaigre.n Quels sont les effets des pluies acides ? nLes effets causés par l'eau acide dépendent de plusieurs facteurs, tels que le degré d'acidité de l'eau, la composition chimique du sol et son pouvoir tampon, ainsi que les caractéristiques des organismes vivants affectés.nLes dépôts acides contribuent à l'abaissement du pH dans les écosystèmes terrestres et aquatiques et permettent la mobilisation de métaux toxiques, en particulier de l'aluminium. Les effets sont multiples : dégâts sur les forêts et les sols, sur les poissons et autres organismes vivants, sur les matériaux de construction et sur la santé humaine. Les pluies acides réduisent également la visibilité.n Dans les forêts, les pluies acides causent des dommages en décomposant les nutriments du sol, ce qui entrave la croissance naturelle des arbres. Les effets des pluies acides sur le sol peuvent être accrus dans les forêts des régions de haute montagne, où le brouillard apporte des quantités importantes de polluants acides.n Les pluies acides contribuent à la dégradation des matériaux de construction et d'art (par exemple, les mauvaises pierres) et à la corrosion des métaux. Les monuments et les bâtiments sont sensibles à l'action des pluies acides. De nombreuses ruines ont disparu ou sont sur le point de disparaître à cause de ce facteur.nLes dommages causés à l'homme sont principalement indirects, par la consommation de poissons et d'eau potable contaminés par les pluies acides.nComment les pluies acides peuvent-elles être réduites ? nPour réduire les pluies acides, il est nécessaire de réduire les émissions des composés chimiques qui donnent naissance aux acides, c'est-à-dire les précurseurs d'acides, qui sont principalement le dioxyde de soufre (SO2) et les oxydes d'azote (monoxyde d'azote, NO, et dioxyde d'azote, NO2). De nos jours, il est possible de réduire la formation de SO2 en retirant le soufre des combustibles fossiles ou en piégeant le SOx avant qu'il ne soit émis dans l'atmosphère, grâce à des réactions chimiques qui le transforment en espèces chimiques moins réactives. L'utilisation de convertisseurs catalytiques réduit la formation de NO et de NO2 en réduisant ces oxydes en N2 et O2.")
                            print('APPENDED DEEPL')

                        elif other_language=='zh' and text == 'Lluvia ácidanLa lluvia ácida es una forma de contaminación ácida, que hace referencia a la caída (deposición) de ácidos presentes en la atmósfera a través de la lluvia, niebla y nieve (también conocida como deposición húmeda).nLos principales precursores de los ácidos, son los óxidos de azufre (SOx) y los óxidos de nitrógeno (NOx), que son emitidos por las termoeléctricas, los motores de combustión interna de coches y aviones y algunas otras industrias, como producto de la combustión de combustibles que contienen pequeños porcentajes de azufre (S) y nitrógeno (N), como el carbón, gas natural, gas oil, petróleo, etc.nLos ácidos, principalmente ácido sulfúrico y ácido nítrico, se disuelven en las gotas de agua que forman las nubes y en las propias gotas de agua de lluvia, depositándose en el suelo. Ambos ácidos se originan en la atmósfera al reaccionar el trióxido de azufre (SO3) y el dióxido de nitrógeno (NO2) con agua, oxígeno y otras sustancias químicas presentes. En presencia de luz solar aumenta la velocidad de la mayoría de estas reacciones.nExiste también otra forma de contaminación ácida conocida como deposición seca, y hace referencia a gases y partículas ácidos que son arrastrados por el viento, chocando contra edificios, coches, casas y árboles. Otra vía de arrastre son las lluvias fuertes. En este caso las sustancias ácidas se incorporan a la lluvia ácida, lo que contribuye a aumentar su acidez.nAproximadamente la mitad de las sustancias ácidas en la atmósfera caen al suelo por procesos de deposición seca.n¿Cómo se mide la lluvia ácida?nLa lluvia ácida se mide según la escala de "pH", potencial hidrógeno. Cuanto más bajo sea el pH de una sustancia, es más ácida.nEl agua pura tiene un pH de 7.0 y normalmente la lluvia tiene un pH entre 5 y 6, es decir, es ligeramente ácida, por llevar ácido carbónico que se forma cuando el dióxido de carbono del aire se disuelve en el agua que cae. En cambio, en zonas con la atmósfera contaminada por estas sustancias acidificantes, la lluvia tiene valores de pH de hasta 4 ó 3 y, en algunas zonas en que la niebla es ácida, el pH puede llegar a ser de 2 ó 3, es decir similar al del zumo del limón o al del vinagre.n¿Cuáles son los efectos de la lluvia ácida?nLos efectos ocasionados por el agua ácida dependerán de diversos factores, como el grado de acidez del agua, la composición química del suelo y su capacidad de "amortiguación" (buffering), así como de las características de los organismos vivos afectados.nLa deposición ácida contribuye a la reducción del pH en ecosistemas terrestres y acuáticos y permite la movilización de metales tóxicos, especialmente del aluminio. Esto ocasiona una variedad de efectos, como son daños a bosques y suelos, peces y otros seres vivos, materiales de construcción y a la salud humana. Asimismo, la lluvia ácida actúa reduciendo la visibilidad.nEn los bosques, la lluvia ácida produce daños al descomponer los nutrientes del suelo, dificultando el crecimiento natural de los árboles. El daño se puede extender a los pastos de las praderas, perjudicando al ganado, y a los lagos, pudiendo ocasionar la muerte de gran cantidad de peces.nLos efectos de la lluvia ácida en el suelo pueden verse incrementados en bosques de zonas de alta montaña, donde la niebla contribuye a aportar cantidades importantes de los contaminantes ácidos.nLa lluvia ácida contribuye a la degradación de los materiales de construcción y artísticos (mal de piedra) y la corrosión metálica. Los monumentos y edificios son sensibles a la acción de la lluvia ácida. Muchas ruinas han desaparecido o están por de hacerlo, a causa de este factor.nEl daño que produce a las personas es principalmente indirecto, mediante el consumo de peces y agua potable contaminados por la lluvia ácida.n¿Cómo se puede reducir la lluvia ácida?nPara reducir la lluvia ácida es necesario disminuir la emisión de los compuestos químicos que dan origen a los ácidos, es decir, de los precursores de los ácidos, los cuales son principalmente el bióxido de azufre (SO2) y los óxidos de nitrógeno (monóxido de nitrógeno, NO, y bióxido de nitrógeno, NO2).nEn la actualidad se puede disminuir la formación de SO2 eliminando el azufre de los combustibles fósiles o atrapando los SOx antes que se emitan a la atmósfera, mediante reacciones químicas que los transforman en especies químicas menos reactivas. La utilización de convertidores catalíticos disminuye la formación de NO y NO2, puesto que reducen dichos óxidos a N2 y O2.':
                            
                            translated_texts.append("酸雨酸雨是酸污染的一种形式，是指大气中存在的酸通过雨、雾和雪降落（沉积）（也称为湿沉积）。 酸的主要前体是硫氧化物（SOx）和氮氧化物（NOx），由发电厂、汽车和飞机的内燃机以及其他一些工业排放，是煤炭、天然气、天然气油、石油等含有少量硫（S）和氮（N）的燃料燃烧后的产物。 酸，主要是硫酸和硝酸，溶解在形成云的水滴和雨滴中，沉积在地面上。当三氧化硫（SO3）和二氧化氮（NO2）与水、氧气和其他化学物质发生反应时，这两种酸就会在大气中产生。n 还有另一种形式的酸性污染称为干沉降，是指酸性气体和颗粒随风飘散，撞击建筑物、汽车、房屋和树木。另一种冲刷途径是暴雨。在这种情况下，酸性物质会融入酸雨中，从而增加酸雨的酸度。n大气中约有一半的酸性物质是通过干沉降过程落到地面的。纯水的pH值为7.0，而雨水的pH值通常在5到6之间，即略带酸性，其中含有空气中的二氧化碳溶解在降水中形成的碳酸。相反，在大气受到这些酸化物质污染的地区，雨水的 pH 值高达 4 或 3，而在一些雾气呈酸性的地区，雨水的 pH 值可高达 2 或 3，类似于柠檬汁或醋的 pH 值。 酸性水造成的影响取决于多个因素，如水的酸度、土壤的化学成分及其缓冲能力，以及受影响生物的特性。这造成了多种影响，包括对森林和土壤、鱼类和其他生物、建筑材料以及人类健康的破坏。在森林中，酸雨会分解土壤养分，阻碍树木的自然生长，从而造成破坏。n 在高山地区的森林中，酸雨对土壤的影响会更大，因为雾会产生大量酸性污染物。n 酸雨会导致建筑和艺术材料（如劣质石材）退化和金属腐蚀。古迹和建筑对酸雨的作用非常敏感。n 如何减少酸雨？ 要减少酸雨，就必须减少产生酸的化合物（即酸前体）的排放，这些化合物主要是二氧化硫（SO2）和氮氧化物（一氧化氮和二氧化氮）。 如今，可以通过去除化石燃料中的硫或在二氧化硫排放到大气中之前将其捕获，通过化学反应将其转化为活性较低的化学物质，从而减少二氧化硫的形成。使用催化转换器可将这些氧化物还原成 N2 和 O2，从而减少 NO 和 NO2 的形成。")
                            print('APPENDED DEEPL')

                        elif other_language=='zh' and text == "Il existe un certain nombre de façons d'améliorer la validité d'une expérience, notamment en contrôlant davantage de variables, en améliorant la technique de mesure, en augmentant la randomisation pour réduire le biais de l'échantillon, en mettant l'expérience en aveugle et en ajoutant des groupes témoins ou placebo.   Contrôler plus de variables consiste à s'assurer que le moins de choses possible changent au cours de l'expérience.  Une expérience idéale est celle où une chose est modifiée et un résultat est examiné.  Tout le reste doit rester le même.  Ainsi, par exemple, si vous vouliez savoir à quelle vitesse des balles de masses différentes rouleront sur une colline particulière, vous modifieriez la masse de la balle et garderiez tout le reste identique.  Vous conserveriez le matériau de la balle, le point de libération, le lieu de mesure, une méthode, l'humidité de l'air, la hauteur au-dessus du niveau de la mer et tout ce que vous pouvez penser de la même manière.  Plus vous gardez le même, plus il est probable que votre résultat sera valide.   La technique de mesure peut également être améliorée.  Peut-être qu'au lieu de mesurer quelque chose à la main, vous pourriez utiliser un ordinateur et un capteur électronique.  Ou peut-être qu'au lieu de demander à une personne de mesurer les résultats, vous pourriez demander à plusieurs personnes de prendre des mesures et de comparer leurs réponses.   Augmenter la randomisation est un moyen de réduire un problème de validité particulier : le biais d'échantillon.  C'est alors que les échantillons étudiés ne sont pas un échantillon représentatif de la population.  Par exemple, disons que vos tests pour l'effet d'un médicament et vos essais contiennent principalement des hommes blancs entre _20 et 30 ans.  Ce ne serait pas un bon échantillon en raison du manque d'étendue, d'âge et de sexe. Ou peut-être testez-vous des médicaments amaigrissants sur des personnes qui ont déjà un poids santé.  L'augmentation de la randomisation de l'échantillon réduira ce problème.":
                            
                            translated_texts.append("提高实验有效性的方法有很多，包括控制更多变量、改进测量技术、增加随机化以减少样本偏差、对实验进行盲法处理以及增加对照组或安慰剂组。  控制更多变量是指确保在实验过程中尽可能少地改变事物。 理想的实验是改变一件事，检查一个结果。 其他一切都应保持不变。 因此，举例来说，如果你想知道不同质量的球从一个特定的山坡上滚下来的速度有多快，你可以改变球的质量，其他一切保持不变。 球的材料、释放点、测量地点、方法、空气湿度、海拔高度以及你能想到的任何其他因素都保持不变。 越是保持相同，结果就越有可能有效。  测量技术也可以改进。 也许你可以使用电脑和电子传感器来代替手工测量。 或者，与其让一个人测量结果，不如让几个人测量并比较他们的答案。  增加随机性是减少特定有效性问题的一种方法：样本偏差。 这是指研究的样本不是人口的代表性样本。 例如，假设您在测试一种药物的效果时，试验对象主要是年龄在 20 岁至 30 岁之间的白人男性。 这不是一个好的样本，因为缺乏范围、年龄和性别。或者，您正在对体重已经处于健康水平的人进行减肥药物试验。 增加样本的随机性可以减少这个问题。")
                            print('APPENDED DEEPL')

                        elif other_language=='de' and text == "Il existe un certain nombre de façons d'améliorer la validité d'une expérience, notamment en contrôlant davantage de variables, en améliorant la technique de mesure, en augmentant la randomisation pour réduire le biais de l'échantillon, en mettant l'expérience en aveugle et en ajoutant des groupes témoins ou placebo.   Contrôler plus de variables consiste à s'assurer que le moins de choses possible changent au cours de l'expérience.  Une expérience idéale est celle où une chose est modifiée et un résultat est examiné.  Tout le reste doit rester le même.  Ainsi, par exemple, si vous vouliez savoir à quelle vitesse des balles de masses différentes rouleront sur une colline particulière, vous modifieriez la masse de la balle et garderiez tout le reste identique.  Vous conserveriez le matériau de la balle, le point de libération, le lieu de mesure, une méthode, l'humidité de l'air, la hauteur au-dessus du niveau de la mer et tout ce que vous pouvez penser de la même manière.  Plus vous gardez le même, plus il est probable que votre résultat sera valide.   La technique de mesure peut également être améliorée.  Peut-être qu'au lieu de mesurer quelque chose à la main, vous pourriez utiliser un ordinateur et un capteur électronique.  Ou peut-être qu'au lieu de demander à une personne de mesurer les résultats, vous pourriez demander à plusieurs personnes de prendre des mesures et de comparer leurs réponses.   Augmenter la randomisation est un moyen de réduire un problème de validité particulier : le biais d'échantillon.  C'est alors que les échantillons étudiés ne sont pas un échantillon représentatif de la population.  Par exemple, disons que vos tests pour l'effet d'un médicament et vos essais contiennent principalement des hommes blancs entre _20 et 30 ans.  Ce ne serait pas un bon échantillon en raison du manque d'étendue, d'âge et de sexe. Ou peut-être testez-vous des médicaments amaigrissants sur des personnes qui ont déjà un poids santé.  L'augmentation de la randomisation de l'échantillon réduira ce problème.":
                            
                            translated_texts.append("Es gibt eine Reihe von Möglichkeiten, die Validität eines Experiments zu verbessern, z. B. durch die Kontrolle von mehr Variablen, die Verbesserung der Messtechnik, die Erhöhung der Randomisierung zur Verringerung der Stichprobenverzerrung, die Verblindung des Experiments und die Hinzufügung von Kontroll- oder Placebogruppen.   Mehr Variablen zu kontrollieren bedeutet, dafür zu sorgen, dass sich während des Experiments so wenig wie möglich ändert.  Ein ideales Experiment ist eines, bei dem eine Sache verändert und ein Ergebnis untersucht wird.  Alles andere sollte gleich bleiben.  Wenn Sie also z. B. herausfinden wollten, wie schnell Bälle mit unterschiedlicher Masse über einen bestimmten Hügel rollen, würden Sie die Masse des Balles verändern und alles andere gleich lassen.  Sie würden das Material des Balles, den Freisetzungspunkt, den Messort, eine Methode, die Luftfeuchtigkeit, die Höhe über dem Meeresspiegel und alles andere, was Sie sich vorstellen können, auf die gleiche Weise beibehalten.  Je länger Sie das Gleiche beibehalten, desto wahrscheinlicher ist es, dass Ihr Ergebnis gültig ist.   Auch die Messtechnik kann verbessert werden.  Vielleicht könnten Sie, anstatt etwas mit der Hand zu messen, einen Computer und einen elektronischen Sensor verwenden.  Oder vielleicht könnten Sie, anstatt eine Person zu bitten, die Ergebnisse zu messen, mehrere Personen bitten, Messungen vorzunehmen und ihre Antworten zu vergleichen.   Die Randomisierung zu erhöhen ist eine Möglichkeit, ein bestimmtes Validitätsproblem zu reduzieren: den Stichprobenbias.  Das ist dann der Fall, wenn die untersuchten Stichproben keine repräsentative Stichprobe der Bevölkerung sind.  Nehmen wir zum Beispiel an, dass Ihre Tests für die Wirkung eines Medikaments und Ihre Studien hauptsächlich weiße Männer zwischen _20 und 30 Jahren enthalten.  Das wäre aufgrund des fehlenden Umfangs, des Alters und des Geschlechts keine gute Stichprobe. Oder vielleicht testen Sie Medikamente zum Abnehmen an Personen, die bereits ein gesundes Gewicht haben.  Eine stärkere Randomisierung der Stichprobe würde dieses Problem verringern.")
                            print('APPENDED DEEPL')

                        elif other_language=='en' and text == "Il existe un certain nombre de façons d'améliorer la validité d'une expérience, notamment en contrôlant davantage de variables, en améliorant la technique de mesure, en augmentant la randomisation pour réduire le biais de l'échantillon, en mettant l'expérience en aveugle et en ajoutant des groupes témoins ou placebo.   Contrôler plus de variables consiste à s'assurer que le moins de choses possible changent au cours de l'expérience.  Une expérience idéale est celle où une chose est modifiée et un résultat est examiné.  Tout le reste doit rester le même.  Ainsi, par exemple, si vous vouliez savoir à quelle vitesse des balles de masses différentes rouleront sur une colline particulière, vous modifieriez la masse de la balle et garderiez tout le reste identique.  Vous conserveriez le matériau de la balle, le point de libération, le lieu de mesure, une méthode, l'humidité de l'air, la hauteur au-dessus du niveau de la mer et tout ce que vous pouvez penser de la même manière.  Plus vous gardez le même, plus il est probable que votre résultat sera valide.   La technique de mesure peut également être améliorée.  Peut-être qu'au lieu de mesurer quelque chose à la main, vous pourriez utiliser un ordinateur et un capteur électronique.  Ou peut-être qu'au lieu de demander à une personne de mesurer les résultats, vous pourriez demander à plusieurs personnes de prendre des mesures et de comparer leurs réponses.   Augmenter la randomisation est un moyen de réduire un problème de validité particulier : le biais d'échantillon.  C'est alors que les échantillons étudiés ne sont pas un échantillon représentatif de la population.  Par exemple, disons que vos tests pour l'effet d'un médicament et vos essais contiennent principalement des hommes blancs entre _20 et 30 ans.  Ce ne serait pas un bon échantillon en raison du manque d'étendue, d'âge et de sexe. Ou peut-être testez-vous des médicaments amaigrissants sur des personnes qui ont déjà un poids santé.  L'augmentation de la randomisation de l'échantillon réduira ce problème.":
                            
                            translated_texts.append("There are a number of ways to improve the validity of an experiment, including controlling more variables, improving the measurement technique, increasing randomization to reduce sample bias, blinding the experiment and adding control or placebo groups.   Controlling more variables means ensuring that as few things as possible change during the course of the experiment.  An ideal experiment is one in which one thing is changed and one result is examined.  Everything else should remain the same.  So, for example, if you wanted to know how fast balls of different masses would roll down a particular hill, you would change the mass of the ball and keep everything else the same.  You'd keep the material of the ball, the point of release, the place of measurement, a method, the humidity of the air, the height above sea level and anything else you can think of the same.  The more you keep it the same, the more likely it is that your result will be valid.   The measurement technique can also be improved.  Maybe instead of measuring something by hand, you could use a computer and an electronic sensor.  Or perhaps instead of asking one person to measure the results, you could ask several people to take measurements and compare their answers.   Increasing randomization is one way of reducing a particular validity problem: sample bias.  This is when the samples studied are not a representative sample of the population.  For example, let's say your tests for the effect of a drug and your trials contain mainly white males between _20 and 30 years of age.  This would not be a good sample because of the lack of range, age and gender. Or perhaps you're testing weight-loss drugs on people who are already at a healthy weight.  Increasing the randomization of the sample will reduce this problem.")
                            print('APPENDED DEEPL')
                            
                        elif other_language=='es' and text == "Il existe un certain nombre de façons d'améliorer la validité d'une expérience, notamment en contrôlant davantage de variables, en améliorant la technique de mesure, en augmentant la randomisation pour réduire le biais de l'échantillon, en mettant l'expérience en aveugle et en ajoutant des groupes témoins ou placebo.   Contrôler plus de variables consiste à s'assurer que le moins de choses possible changent au cours de l'expérience.  Une expérience idéale est celle où une chose est modifiée et un résultat est examiné.  Tout le reste doit rester le même.  Ainsi, par exemple, si vous vouliez savoir à quelle vitesse des balles de masses différentes rouleront sur une colline particulière, vous modifieriez la masse de la balle et garderiez tout le reste identique.  Vous conserveriez le matériau de la balle, le point de libération, le lieu de mesure, une méthode, l'humidité de l'air, la hauteur au-dessus du niveau de la mer et tout ce que vous pouvez penser de la même manière.  Plus vous gardez le même, plus il est probable que votre résultat sera valide.   La technique de mesure peut également être améliorée.  Peut-être qu'au lieu de mesurer quelque chose à la main, vous pourriez utiliser un ordinateur et un capteur électronique.  Ou peut-être qu'au lieu de demander à une personne de mesurer les résultats, vous pourriez demander à plusieurs personnes de prendre des mesures et de comparer leurs réponses.   Augmenter la randomisation est un moyen de réduire un problème de validité particulier : le biais d'échantillon.  C'est alors que les échantillons étudiés ne sont pas un échantillon représentatif de la population.  Par exemple, disons que vos tests pour l'effet d'un médicament et vos essais contiennent principalement des hommes blancs entre _20 et 30 ans.  Ce ne serait pas un bon échantillon en raison du manque d'étendue, d'âge et de sexe. Ou peut-être testez-vous des médicaments amaigrissants sur des personnes qui ont déjà un poids santé.  L'augmentation de la randomisation de l'échantillon réduira ce problème.":
                            
                            translated_texts.append("Hay varias formas de mejorar la validez de un experimento, como controlar más variables, mejorar la técnica de medición, aumentar la aleatorización para reducir el sesgo de la muestra, cegar el experimento y añadir grupos de control o placebo.   Controlar más variables significa garantizar que cambie el menor número posible de cosas a lo largo del experimento.  Un experimento ideal es aquel en el que se cambia una cosa y se examina un resultado.  Todo lo demás debe permanecer igual.  Así, por ejemplo, si quisiéramos saber a qué velocidad bajan por una colina pelotas de masas diferentes, cambiaríamos la masa de la pelota y mantendríamos todo lo demás igual.  Mantendrías igual el material de la pelota, el punto de lanzamiento, el lugar de medición, un método, la humedad del aire, la altura sobre el nivel del mar y cualquier otra cosa que se te ocurra.  Cuanto más se mantenga igual, más probabilidades habrá de que el resultado sea válido.   También se puede mejorar la técnica de medición.  Quizá en lugar de medir algo a mano, podrías utilizar un ordenador y un sensor electrónico.  O quizá en lugar de pedir a una persona que mida los resultados, podría pedir a varias personas que tomaran medidas y compararan sus respuestas.   Aumentar la aleatorización es una forma de reducir un problema de validez concreto: el sesgo de la muestra.  Esto ocurre cuando las muestras estudiadas no son una muestra representativa de la población.  Por ejemplo, supongamos que sus pruebas para determinar el efecto de un fármaco y sus ensayos contienen principalmente hombres blancos de entre _20 y 30 años.  Esta no sería una buena muestra debido a la falta de rango, edad y sexo. O quizás esté probando fármacos para perder peso en personas que ya tienen un peso saludable.  Aumentar la aleatorización de la muestra reducirá este problema.")
                            print('APPENDED DEEPL')

                        else:

                            translated_texts.append(translation_model.translate(text, source_lang=language_codes[language], target_lang=language_codes[other_language]))
                        
                        df_copy['text'] = translated_texts + ([''] * (len(original_texts) - len(translated_texts)))
                        df_copy.to_csv(os.path.join(data_path, prompt, language, 'partial_fold_' + str(fold) + '_translated_' + other_language + '_' + translation_model_name + '.csv'))

                    df_copy.to_csv(target_file)
            
                else:
                    
                    print('Already Done', prompt, language, other_language, fold)
